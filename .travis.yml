language: objective-c
osx_image: xcode7.3
cache:
    - cocoapods
env:
    global:
    - WORKSPACE="RealmS.xcworkspace"
    - SCHEME="RealmS"
    - SDK="iphonesimulator9.3"
    - DESTINATION="OS=9.3,name=iPhone 6"
    - POD_LINT="YES"
before_install:
    - set -o pipefail
    - if [[ `pod --version` == 0.* ]]; then gem install cocoapods; pod repo update; fi
    - pod install
script:
    # test Debug
    - xctool analyze -workspace "$WORKSPACE" -scheme "$SCHEME" -sdk "$SDK" -destination "$DESTINATION" ONLY_ACTIVE_ARCH=YES GCC_INSTRUMENT_PROGRAM_FLOW_ARCS=YES GCC_GENERATE_TEST_COVERAGE_FILES=YES -configuration Debug
    # pod lint if needs
    - if [ $POD_LINT == "YES" ]; then pod lib lint --quick; fi
notifications:
    email: false
after_success:
    - bash <(curl -s https://codecov.io/bash)
